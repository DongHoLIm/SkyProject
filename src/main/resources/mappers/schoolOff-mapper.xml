<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="SchoolOff">
  	<resultMap type="SchoolOff" id="schoolOffResultSet">
  		<id property="studentNo" column="STUDENT_NO"/>
  		<id property="applyNo" column="APPLY_NO"/>
  		<result property="applyDate" column="APPLY_DATE"/>
  		<result property="offStart" column="OFF_START"/>
  		<result property="offType" column="OFF_TYPE"/>
  		<result property="offReason" column="OFF_REASON"/>
  		<result property="offTerm" column="OFF_TERM"/>
  		<result property="returnDate" column="RETURN_DATE"/>
  		<result property="enlistmentDate" column="ENLISTMENT_DATE"/>
  		<result property="demobilizationDate" column="DEMOBILIZATION_DATE"/>
  		<result property="offStatus" column="OFF_STATUS"/>
  		<result property="college" column="COLLEGE_NAME"/>
  		<result property="major" column="SDEPT_NAME"/>
  		<result property="kName" column="MEMBER_KNAME"/>
  	
  	</resultMap>
  	
  	<select id="selectSchoolOff" resultMap="schoolOffResultSet">
  		SELECT OFF_TYPE, OFF_REASON, OFF_START, RETURN_DATE, APPLY_DATE, OFF_STATUS
  		FROM OFF_SCHOOL
  		WHERE STUDENT_NO= #{studentNo}
  	</select>
  	
  	<insert id="schoolOffApply" parameterType="SchoolOff">
  		INSERT INTO OFF_SCHOOL (APPLY_DATE,OFF_TYPE,OFF_REASON,OFF_TERM,RETURN_DATE,
								ENLISTMENT_DATE,DEMOBILIZATION_DATE,REQUIRED_DOC,
								OFF_START,OFF_STATUS,APPLY_NO,STUDENT_NO) 
		VALUES(SYSDATE, #{offType}, #{offReason}, #{offTerm}, #{returnDate}, 
				#{enlistmentDate}, #{demobilizationDate}, #{requiredDoc}, 
				#{offStart}, DEFAULT, SEQ_OFFSCHOOL.NEXTVAL, #{studentNo})
  	</insert>
  	
  	<select id="getOffApplyListCount" resultType="_int">
  		SELECT COUNT(*)
  		FROM OFF_SCHOOL
  		WHERE OFF_STATUS='신청완료' OR OFF_STATUS='서류확인'
  	</select>
  	
  	<!-- <select id="selectOffApplyList" parameterType="SchoolOff">
  		SELECT
  		FROM OFF_SCHOOL
  	</select> -->
  	
  	<select id="getOffFilterListCount" resultType="_int" parameterType="OffApplyFilter">
  		SELECT COUNT(*)
  		FROM OFF_SCHOOL
  		<where>
  			<if test = "offStatus == '처리상태'">
				AND (OFF_STATUS='신청완료' OR OFF_STATUS='서류확인')
			</if>
			<if test = "offStatus != '처리상태'">
				AND OFF_STATUS = #{offStatus}
			</if>
			<if test = "offType != '휴학구분'">
				AND OFF_TYPE = #{offType}
			</if> 
		</where>
  	</select>
  	
  	<!-- <select id="selectOffFilterStudent" resultMap="schoolOffResultSet" parameterType="OffApplyFilter">
  	
  	</select> -->
  
  
  
  
  
  </mapper>